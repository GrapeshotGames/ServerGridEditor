# Early WIP ServerGridEditor for Atlas

Initially created by Instinct Games. Feel free to edit and use how you please or contribute to make this better for all that use it. In the end it just is a quick example of how to generate the json for the game [Atlas](https://playatlas.com).

A fully web version or even another C# one but in WPF might prove better for your needs! 

## Infromation
For more information about Atlas please visit [playatlas.com](https://playatlas.com).

## Server Basics 
The anonymous server ID for steam is 1006030 and can be downloaded using the steamcmd tool. The functionality of steamcmd is beyond this guide, but the following command should get you started:

`steamcmd.exe +login anonymous  +force_install_dir c:\games\atlas +app_update 1006030 +quit` 
 
Servers are broken up into grid squares, each square representing both a server and a grid coordinate within the cluster. For example, to have a 2x2 map square you would need to configure 4 server instances. Each instance requires a game and query port, plus a shared 'seamless' port used to make thme appear as one server. Each server also requires the following files generated by the ServerGridEditor:
* ServerGrid.json - Contains map data and server settings info.
* ServerGrid.ServerOnly.json - Contains db settings and related config data.
* Map Images (.jpg & .png) - Map images including zoom level images produced based on cluster setup.

## Guided Basic Setup
The following are the basic setup steps for building a 2x2 server cluster of 4 servers total, using the Small template provided in the `Projects` folder.
1. Download the latest version of the server via steam (see above example).
2. Download a copy of ServerGridEditor (can be ran on any computer for config setup).
3. Go to the projects folder in ServerGridEditor's main folder after extracting the folder.
  * Rename ServerGrid.json to ServerGrid.Large.json
  * Rename ServerGridSmall.json to ServerGrid.json
  * Copy ServerGrid.json to a second file called ServerGrid.json.bak (as a backup).
4. Run ServerGridEditor.exe
5. Click Project -> Open -> Select `ServerGrid.json` -> open
6. Once the 2x2 grid is open, left click + ctrl the first grid square somewhere in the ocean where there is only water.
  * With the server settings open, change the IP of the server to the external IP of that server and configure the unique ports based on your settings.
  * Repeat this step for each grid square, clicking on 'Save' after adjusting settings for each server.
7. Click Project -> Edit. When finished, save your changes by clicking the 'Edit' button on the bottom of the popup menu.
  * Change the Atlas ID to something unique for your servers to share.
  * In the `BaseServerArgs` field, update the SeamlessIP to be the external IP all servers will use.
  * (Optional) Update your MaxPlayers and ReservedPlayerSlots (these subtract from your public max, so be wise with both numbers).
  * (Optional) If you want to set a server password place it in the `Atlas Password` field above `BaseServerArgs`
  * ***NOTICE:*** While (Optional), you should change the password for the database settings on this menu. Make note of it and update the password later in the server folder `{your atlas server folder}/AtlasTools/RedisDatabase/redis.conf` by searching for the old password.
  * (Optional) If you run your Redis server from a separate server from all the others, update the server IP in database settings.
8. Sometimes people have ship paths outside of their grid square, which causes exceptions. You can view this by Checkmarking `Show Ship Paths` at the bottom of the tool menu. Then slowly zoom out and see if any exist.
  * You can left click the black circles for the paths and drag them somewhere onto the map area, just keep the boats in the water.
9. Once done, click `Project -> Save`. Now you need to generate map images by going to the `Export` Menu and selecting Map Images, Cell Images, and/or Slippy Map


